<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kneipenbewertung</title>
<link rel="stylesheet" href="css/site.css">
<link rel="stylesheet"
	href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
	integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
	crossorigin="" />

<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
	integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
	crossorigin=""></script>

<script src="js/functions.js"></script>

<script type="text/javascript">

var nameOk = false;
var telefonOk = false;
var emailOk = false;

function checkIfAllOk()
{
	let allOk = nameOk && emailOk;
	if( allOk )
	{
		document.querySelector("#regist").disabled=false;
	}
	else
    {
		document.querySelector("#regist").disabled=true;
    }
}
function checkNameOnFocus()
{
	document.querySelector("#errorName").innerHTML = "";
}

function checkFNameOnBlur()
{
	if( document.querySelector("#fname").value.length == 0 )
		return;

	if( nameOk == false )
	{
	   document.querySelector("#errorName").innerHTML = "Format des Namens ist falsch";
	}
}

function checkLNameOnBlur()
{
	if( document.querySelector("#lname").value.length == 0 )
		return;

	if( nameOk == false )
	{
	   document.querySelector("#errorName").innerHTML = "Format des Namens ist falsch";
	}
}

function checkName()
{
	let lnameInput = document.querySelector("#name").value;
	let fnameInput = document.querySelector("#name").value;
	if( fnameInput.length === 0 || lnameInput.length === 0)
	   return;

	let nameRegEx = /^[A-ZÄÖÜ][a-zäöüß]+(-[A-ZÄÖÜ][a-zäöüß]+)*$/;
	if( nameRegEx.test( lnameInput ) == false || nameRegEx.test( fnameInput ) == false)
	{
		nameOk = false;
	}
	else
	{
		nameOk = true;
	}
	checkIfAllOk();
}


function checkEmailOnFocus()
{
	document.querySelector("#errorEmail").innerHTML = "";
}

function checkEmailOnBlur()
{
	if( document.querySelector("#email").value.length == 0 )
		return;

	if( emailOk == false )
	{
	  document.querySelector("#errorEmail").innerHTML = "Format der E-Mail-Adresse ist falsch";
	}
}

function checkEmail()
{
	emailOk = false;

	let emailInput = document.querySelector("#email").value;
	if( emailInput.length === 0 )
		return;

	let emailRegEx = /^\w{4}\d{4,}@stud\.(hs-kl|fh-kl)\.de$/;
	if( emailRegEx.test( emailInput ) == false )
	{
		emailOk = false;
	}
	else
	{
		emailOk = true;
	}

	checkIfAllOk();
}

</script>

</head>
<body>
	<div class="mainContainer">
		<header>
			<div>
				<span style="white-space: nowrap"> Benutzer: <input
					id="userNameLogin" type="text" name="userName" required />
				</span> <span style="white-space: nowrap"> Password: <input
					id="passwordLogin" type="password" name="password" required />
				</span>
				<button type="button" style="width: 100px;">Anmelden</button>
				<span style="float: right; white-space: nowrap"> <a href="javascript:showRegistration()">
						Als neuer Benutzer registrieren</a></span>
			</div>
		</header>
		<article><div id="mapid" style="height:100%;"></div></article>
		<aside id="side"><h3>Hier sind  die Infos zur ausgewählten Kneipe</h3><br/></aside>
		<footer> Hier stehen später die gemachten Bewertungen </footer>
	</div>
</body>

<div id="registration" style="display : none">
	<h3>Registrierung</h3>
	<table>
		<tr>
			<td>Vorname</td>
			<td><input type="text" id="firstname" size="40" required onkeyup="checkName()" onblur="checkFNameOnBlur()" onfocus="checkNameOnFocus()"/></td>
		</tr>
		<tr>
			<td>Nachname</td>
			<td><input type="text" id="lastname" size="40" required onkeyup="checkName()" onblur="checkLNameOnBlur()" onfocus="checkNameOnFocus()"/></td>
		</tr>
		<tr>
			<td>Straße</td>
			<td><input type="text" id="street" size="25" /> <span
					style="float: right;"> Nr: <input type="text" name="streetNr"
													  size="4" />
			</span></td>
		</tr>
		<tr>
			<td>PLZ</td>
			<td><input type="text" name="zip" size="5" /> <span
					style="float: right;"> Ort <input type="text" name="city"
													  size="25" />
			</span></td>
		</tr>
		<tr>
			<td>E-Mail</td>
			<td><input type="email" id="email" size="40" required onkeyup="checkEmail()"  onblur="checkEmailOnBlur()" onfocus="checkEmailOnFocus()"/></td>
		</tr>
		<tr>
			<td>Benutzer-Name</td>
			<td><input type="text" id="username" size="40" required /></td>
		</tr>
		<tr>
			<td>Passwort</td>
			<td><input type="password" id="password" size="40" required /></td>
		</tr>

		<tr>
			<td>&nbsp;</td>
			<td align="center">
				<button type="button" style="width: 100px; height: 30px;" id="regist" disabled>Registrieren</button>
				<button type="button" style="width: 100px; height: 30px;" onclick="hideRegistration()">Abbrechen</button>
			</td>
		</tr>
	</table>
	<div id="errorName"></div>
	<div id="errorEmail"></div>
</div>

</html>